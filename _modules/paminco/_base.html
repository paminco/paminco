
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>paminco._base &#8212; paminco 0.1 documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/blank.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/contentui.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/paminco.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/user_guide.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/api.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/contentui.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/logo1.svg" class="logo" alt="logo">
</a>      


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../getting_started.html">
  Getting Started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../user_guide/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../api/index.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../theory/index.html">
  Theoretical Background
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/paminco/paminco" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for paminco._base</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">MutableSequence</span>
<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span><span class="p">,</span> <span class="n">localtime</span><span class="p">,</span> <span class="n">strftime</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.interpolate</span> <span class="k">as</span> <span class="nn">spip</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_doc</span>
<span class="kn">from</span> <span class="nn">.callback</span> <span class="kn">import</span> <span class="n">CallBackFlag</span><span class="p">,</span> <span class="n">SimpleTimer</span>
<span class="kn">from</span> <span class="nn">.net</span> <span class="kn">import</span> <span class="n">Network</span>
<span class="kn">from</span> <span class="nn">.utils.misc</span> <span class="kn">import</span> <span class="n">callback_to_list</span>


<div class="viewcode-block" id="Base"><a class="viewcode-back" href="../../api/base/generated/paminco._base.Base.html#paminco._base.Base">[docs]</a><span class="k">class</span> <span class="nc">Base</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract solver class.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    network : Network</span>
<span class="sd">        A network.</span>
<span class="sd">    name : str, optional</span>
<span class="sd">        Name of solver. If None (default), an automatic name will be</span>
<span class="sd">        generated.</span>
<span class="sd">    callback : (list of callable), optional</span>
<span class="sd">        Will be called during initialization and run() with flags indicating</span>
<span class="sd">        the status of the algorithm.</span>
<span class="sd">    use_simple_timer : bool, default=True</span>
<span class="sd">        Whether timestamps will be collected during initialization and run.</span>
<span class="sd">    copy_network : bool, default=True</span>
<span class="sd">        Whether to work on a copy of ``network``.</span>
<span class="sd">    </span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    callbacks : list</span>
<span class="sd">        List of callbacks.</span>
<span class="sd">    network</span>
<span class="sd">    name</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">network</span><span class="p">:</span> <span class="n">Network</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">use_simple_timer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">copy_network</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        
        <span class="c1"># Handle callbacks</span>
        <span class="k">if</span> <span class="n">use_simple_timer</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="n">SimpleTimer</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="p">]</span> <span class="o">+</span> <span class="n">callback_to_list</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span> <span class="o">=</span> <span class="n">callback_to_list</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="n">CallBackFlag</span><span class="o">.</span><span class="n">INIT_START</span><span class="p">)</span>
        
        <span class="c1"># Init network</span>
        <span class="k">if</span> <span class="n">copy_network</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_net</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">network</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_net</span> <span class="o">=</span> <span class="n">network</span>

    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="n">CallBackFlag</span><span class="p">,</span> <span class="n">aux_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">aux_callback</span><span class="p">:</span>
            <span class="n">all_cb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span> <span class="o">+</span> <span class="n">callback_to_list</span><span class="p">(</span><span class="n">aux_callback</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">all_cb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span>
        
        <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="n">all_cb</span><span class="p">:</span>
            <span class="n">cb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">network</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Network</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get network obj.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_net</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get name of object.</span>
<span class="sd">        </span>
<span class="sd">        If ``name`` is passed as argument in __init__, it will be</span>
<span class="sd">        returned. Otherwise, an automatically created &#39;name&#39; based on</span>
<span class="sd">        the timestamp will be returned.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Object name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%y%m</span><span class="si">%d</span><span class="s2">-%H:%M&quot;</span><span class="p">,</span> <span class="n">localtime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_init_timestamp</span><span class="p">))</span>
    
    <span class="nd">@name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">value</span></div>


<div class="viewcode-block" id="Config"><a class="viewcode-back" href="../../api/base/generated/paminco._base.Config.html#paminco._base.Config">[docs]</a><span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Base class for configurations.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">out</span></div>


<span class="k">class</span> <span class="nc">BreakpointSolution</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class that stores breakpoint solutions.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    param : float</span>
<span class="sd">        Value of demand multiplier at breakpoint.</span>
<span class="sd">    flow : ndarray</span>
<span class="sd">        Minimum cost at breakpoint.</span>
<span class="sd">    cost : float, optional</span>
<span class="sd">        Total cost of ``flow``, calculated by ``network.cost(flow).sum().``</span>
<span class="sd">    potential : ndarray, optional</span>
<span class="sd">        Optimal node potential vector that induces ``flow``.</span>
<span class="sd">    </span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    param : float</span>
<span class="sd">        Value of demand multiplier at breakpoint.</span>
<span class="sd">    flow : ndarray</span>
<span class="sd">        Minimum cost at breakpoint.</span>
<span class="sd">    cost : float, optional</span>
<span class="sd">        Total cost of ``flow``, calculated by ``network.cost(flow).sum().``</span>
<span class="sd">    potential : ndarray, optional</span>
<span class="sd">        Optimal node potential vector that induces ``flow``.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">param</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">flow</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
            <span class="n">cost</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">potential</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="n">param</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flow</span> <span class="o">=</span> <span class="n">flow</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cost</span> <span class="o">=</span> <span class="n">cost</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">potential</span> <span class="o">=</span> <span class="n">potential</span>


<span class="k">class</span> <span class="nc">TypedList</span><span class="p">(</span><span class="n">MutableSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;List that allows only certain types.</span>
<span class="sd">    </span>
<span class="sd">    https://stackoverflow.com/questions/3487434 @Alex Martelli</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oktypes</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oktypes</span> <span class="o">=</span> <span class="n">oktypes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oktypes</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid list element.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>


<div class="viewcode-block" id="ParametricSolution"><a class="viewcode-back" href="../../api/base/solution.html#paminco._base.ParametricSolution">[docs]</a><span class="k">class</span> <span class="nc">ParametricSolution</span><span class="p">(</span><span class="n">TypedList</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;List that stores `B` BreakpointSolutions.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    breakpoints : sequence of BreakpointSolutions</span>
<span class="sd">    </span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    flow_ip : scipy.interpolate.interpolate.interp1d, optional</span>
<span class="sd">        Interpolator of edge flows.</span>
<span class="sd">    pot_ip : scipy.interpolate.interpolate.interp1d, optional</span>
<span class="sd">        Interpolator of node potentials.</span>
<span class="sd">    has_potentials</span>
<span class="sd">    has_costs</span>
<span class="sd">    arr_param</span>
<span class="sd">    arr_flow</span>
<span class="sd">    arr_cost</span>
<span class="sd">    arr_potential</span>
<span class="sd">    dflow</span>
<span class="sd">    dpi</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">BreakpointSolution</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flow_at</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>

<div class="viewcode-block" id="ParametricSolution.all_params"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolution.all_params.html#paminco._base.ParametricSolution.all_params">[docs]</a>    <span class="k">def</span> <span class="nf">all_params</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">filter_same</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">return_indices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get parameters of all parametric solutions.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filter_same : bool, default=True</span>
<span class="sd">            Whether to remove equal parameters. E.g., [1, 2, 3, 3, 5]</span>
<span class="sd">            will be reduced to [1, 2, 3, 5]</span>
<span class="sd">        return_indices : bool, default=False</span>
<span class="sd">            Whether to return indices of filtered params if</span>
<span class="sd">            ``filter_same`` is True.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        params : np.ndarray</span>
<span class="sd">            Parameters of (filtered) parametric solutions.</span>
<span class="sd">        idx : np.ndarray, optional</span>
<span class="sd">            Indices of filtered params, if ``filter_same`` is True and</span>
<span class="sd">            ``return_indices`` is True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">param</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">filter_same</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]])</span>
            <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">return_indices</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">params</span><span class="p">,</span> <span class="n">idx</span>
        <span class="k">return</span> <span class="n">params</span></div>

<div class="viewcode-block" id="ParametricSolution.flow_at"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolution.flow_at.html#paminco._base.ParametricSolution.flow_at">[docs]</a>    <span class="k">def</span> <span class="nf">flow_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Interpolate flow at param.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        param : array_like</span>
<span class="sd">            1D array of real values to interpolate flow at.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ndarray</span>
<span class="sd">            Flow at param, 2D array of shape (m, d), where d is number of</span>
<span class="sd">            elements in ``param``.</span>
<span class="sd">        </span>
<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        scipy.interpolate.interp1d</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dflow</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">p</span><span class="p">,</span> <span class="n">flow</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flow</span>
            <span class="k">return</span> <span class="n">flow</span> <span class="o">+</span> <span class="p">(</span><span class="n">param</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dflow</span>
            
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;flow_ip&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Flows have not been interpolated.&quot;</span><span class="p">)</span>
        
        <span class="n">flow_ip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flow_ip</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dflow</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">flow_ip</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">param</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">param</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">param</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">param</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Params must increase monotonically.&quot;</span><span class="p">)</span>
            
            <span class="c1"># Valid to interpolate</span>
            <span class="n">param_ip</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="n">param</span> <span class="o">&lt;=</span> <span class="n">flow_ip</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">flow_ip</span><span class="p">(</span><span class="n">param_ip</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_ip</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param</span><span class="p">):</span>
                <span class="n">res_non_ip</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">param</span><span class="p">[</span><span class="n">param</span> <span class="o">&gt;</span> <span class="n">flow_ip</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()]:</span>
                    <span class="n">flow_at_p</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">flow</span> <span class="o">+</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dflow</span>
                    <span class="n">res_non_ip</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flow_at_p</span><span class="p">)</span>
                <span class="n">res_non_ip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res_non_ip</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
                
                <span class="c1"># Stack solutions</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">res</span><span class="p">,</span> <span class="n">res_non_ip</span><span class="p">))</span>
            
            <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span></div>

<div class="viewcode-block" id="ParametricSolution.potential_at"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolution.potential_at.html#paminco._base.ParametricSolution.potential_at">[docs]</a>    <span class="k">def</span> <span class="nf">potential_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Interpolate potential at param.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        param : array_like</span>
<span class="sd">            1D array of real values to interpolate potential at.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ndarray</span>
<span class="sd">            Potential at param, 2D array of shape (n, d), where d is number of</span>
<span class="sd">            elements in ``param``.</span>
<span class="sd">        </span>
<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        scipy.interpolate.interp1d</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">p</span><span class="p">,</span> <span class="n">potential</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">potential</span>
            <span class="k">return</span> <span class="n">potential</span> <span class="o">+</span> <span class="p">(</span><span class="n">param</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span>
        
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;pot_ip&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Potentials have not been interpolated.&quot;</span><span class="p">)</span>
        
        <span class="n">pot_ip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pot_ip</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pot_ip</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">param</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">param</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">param</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">param</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Params must increase monotonically.&quot;</span><span class="p">)</span>
            
            <span class="c1"># Valid to interpolate</span>
            <span class="n">param_ip</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="n">param</span> <span class="o">&lt;=</span> <span class="n">pot_ip</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">pot_ip</span><span class="p">(</span><span class="n">param_ip</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_ip</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param</span><span class="p">):</span>
                <span class="n">res_non_ip</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">param</span><span class="p">[</span><span class="n">param</span> <span class="o">&gt;</span> <span class="n">pot_ip</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()]:</span>
                    <span class="n">pot_at_p</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">potential</span> <span class="o">+</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span>
                    <span class="n">res_non_ip</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pot_at_p</span><span class="p">)</span>
                <span class="n">res_non_ip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res_non_ip</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
                
                <span class="c1"># Stack solutions</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">res</span><span class="p">,</span> <span class="n">res_non_ip</span><span class="p">))</span>
            
            <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span></div>

<div class="viewcode-block" id="ParametricSolution.plot_flow_on_edge"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolution.plot_flow_on_edge.html#paminco._base.ParametricSolution.plot_flow_on_edge">[docs]</a>    <span class="k">def</span> <span class="nf">plot_flow_on_edge</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">edge</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Plot flow on edge.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        edge : int</span>
<span class="sd">            Index of edge to plot flow.</span>
<span class="sd">        x : ndarray, optional</span>
<span class="sd">            Plot flow for demand factor x. If None, flow will be plotted for </span>
<span class="sd">            linspace(min_param, max_param, 100).</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Figure, optional</span>
<span class="sd">            Figure that created ax belongs to if `ax` is None.</span>
<span class="sd">        ax : AxesSubplot, optional</span>
<span class="sd">            Axis where flow is plotted on, retured if None given.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">return_figax</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
            <span class="n">return_figax</span> <span class="o">=</span> <span class="kc">True</span>
        
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">flow_at</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="n">edge</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">return_figax</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

    <span class="k">def</span> <span class="nf">set_interpolators</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dflow</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set interpolator between breakpoints.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dflow : array_like (m, ), optional</span>
<span class="sd">            Slope of flow after last breakpoint-</span>
<span class="sd">        dpi : array_like (n, ), optional</span>
<span class="sd">            Slope of potential after last breakpoint-</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_flow_interpolator</span><span class="p">(</span><span class="n">dflow</span><span class="o">=</span><span class="n">dflow</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_potential_interpolator</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_flow_interpolator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dflow</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Setup scipy flow interpolator between breakpoints</span>
        <span class="n">p</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_params</span><span class="p">(</span><span class="n">filter_same</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">flow</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flow_ip</span> <span class="o">=</span> <span class="n">spip</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">dflow</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dflow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dflow</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_potential_interpolator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Setup scipy potential interpolator between breakpoints</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_potentials</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="n">p</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_params</span><span class="p">(</span><span class="n">filter_same</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">pot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">potential</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pot_ip</span> <span class="o">=</span> <span class="n">spip</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">pot</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">dpi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dpi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dpi</span><span class="p">)</span>

<div class="viewcode-block" id="ParametricSolution.make_save_dict"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolution.make_save_dict.html#paminco._base.ParametricSolution.make_save_dict">[docs]</a>    <span class="k">def</span> <span class="nf">make_save_dict</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">save_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">save_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">save_dict</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="n">save_dict</span><span class="p">[</span><span class="s2">&quot;arr_param&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr_param</span>
        <span class="n">save_dict</span><span class="p">[</span><span class="s2">&quot;arr_flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr_flow</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_costs</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">save_dict</span><span class="p">[</span><span class="s2">&quot;arr_cost&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr_cost</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_potentials</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">save_dict</span><span class="p">[</span><span class="s2">&quot;arr_potential&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr_potential</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dflow</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">save_dict</span><span class="p">[</span><span class="s2">&quot;dflow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dflow</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">save_dict</span><span class="p">[</span><span class="s2">&quot;dpi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span>
        
        <span class="n">save_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">save_dict</span></div>

    <span class="n">make_save_dict</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_doc</span><span class="o">.</span><span class="n">make_save_dict</span><span class="o">.</span><span class="vm">__doc__</span>

<div class="viewcode-block" id="ParametricSolution.save_to_numpy"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolution.save_to_numpy.html#paminco._base.ParametricSolution.save_to_numpy">[docs]</a>    <span class="k">def</span> <span class="nf">save_to_numpy</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">save_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_save_dict</span><span class="p">()</span>
        <span class="n">save_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">np</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="o">**</span><span class="n">save_dict</span><span class="p">)</span></div>
    
    <span class="n">save_to_numpy</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_doc</span><span class="o">.</span><span class="n">save_to_numpy</span><span class="o">.</span><span class="vm">__doc__</span>

<div class="viewcode-block" id="ParametricSolution.to_df"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolution.to_df.html#paminco._base.ParametricSolution.to_df">[docs]</a>    <span class="k">def</span> <span class="nf">to_df</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">prefix_flow</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;edge&quot;</span><span class="p">,</span>
            <span class="n">prefix_potential</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;node&quot;</span><span class="p">,</span>
            <span class="n">add_delta_row</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get ParametricSolution as dataframe.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        prefix_flow : str, default=&quot;edge&quot;</span>
<span class="sd">            Prefix of flow columns.</span>
<span class="sd">        prefix_potential : str, default=&quot;node&quot;</span>
<span class="sd">            Prefix of potential columns.</span>
<span class="sd">        add_delta_row : bool, default=False</span>
<span class="sd">            If True, a row will be appended that contains the slope values</span>
<span class="sd">            of flow (and potential).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Build index</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dflow</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">add_delta_row</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">add_delta_row</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;delta&quot;</span><span class="p">]</span>
        
        <span class="c1"># Build flow df</span>
        <span class="k">if</span> <span class="n">add_delta_row</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dflow</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">arr_flow</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dflow</span><span class="p">)),</span>
                              <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr_flow</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_flow</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        
        <span class="c1"># Build potential df</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_potentials</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">add_delta_row</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">df_pot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">arr_potential</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span><span class="p">)),</span>
                                      <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">df_pot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr_potential</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
            <span class="n">df_pot</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix_potential</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">df_pot</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
            
            <span class="c1"># Merge flow and pot frames</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_pot</span><span class="p">)</span>
        
        <span class="c1"># Set cost in merged frame</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_costs</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;cost&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">arr_cost</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;cost&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr_cost</span>
            <span class="c1"># Bring cost column to front</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
            
        <span class="c1"># Add param column</span>
        <span class="k">if</span> <span class="s2">&quot;delta&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;param&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">arr_param</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;param&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr_param</span>
        
        <span class="c1"># Bring param column to front</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="ParametricSolution.from_arrays"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolution.from_arrays.html#paminco._base.ParametricSolution.from_arrays">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_arrays</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span>
            <span class="n">param</span><span class="p">,</span>
            <span class="n">flow</span><span class="p">,</span>
            <span class="n">potential</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">cost</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">dflow</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParametricSolution</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build ParametricSolution from arrays.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        param : array_like (B, )</span>
<span class="sd">            Parameters at breakpoints.</span>
<span class="sd">        flow : array_like (B, m)</span>
<span class="sd">            Edge flow at ``param``.</span>
<span class="sd">        potential : array_like (B, n), optional</span>
<span class="sd">            Node potential at ``param``.</span>
<span class="sd">        cost : array_like (B, ), optional</span>
<span class="sd">            Total cost of edge ``flow`` at ``param``.</span>
<span class="sd">        dflow : array_like (B, ), optional</span>
<span class="sd">            Slope of flow after last breakpoint.</span>
<span class="sd">        dpi : array_like (B, ), optional</span>
<span class="sd">            Slope of potential after last breakpoint.</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ParametricSolution</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">param</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
        <span class="n">flow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">flow</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">potential</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">potential</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">potential</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">potential</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cost</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cost</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
        
        <span class="c1"># Build class and fill with breakpoint solutions</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">para</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">pot</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="n">potential</span><span class="p">,</span> <span class="n">cost</span><span class="p">)):</span>
            <span class="n">bp</span> <span class="o">=</span> <span class="n">BreakpointSolution</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">para</span><span class="p">),</span> <span class="n">f</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">pot</span><span class="p">)</span>
            <span class="n">ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bp</span><span class="p">)</span>
        
        <span class="c1"># Cleanup</span>
        <span class="n">ps</span><span class="o">.</span><span class="n">set_interpolators</span><span class="p">(</span><span class="n">dflow</span><span class="o">=</span><span class="n">dflow</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">ps</span></div>

<div class="viewcode-block" id="ParametricSolution.from_df"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolution.from_df.html#paminco._base.ParametricSolution.from_df">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_df</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span>
            <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
            <span class="n">prefix_flow</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;edge&quot;</span><span class="p">,</span>
            <span class="n">prefix_potential</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;node&quot;</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParametricSolution</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build ParametricSolution from pandas.DataFrame.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df : pandas.DataFrame</span>
<span class="sd">            Dataframe used to build ParametricSolution.</span>
<span class="sd">        prefix_flow : str, default=&quot;edge&quot;</span>
<span class="sd">            Prefix of columns in ``df`` that hold edge flows. Column names</span>
<span class="sd">            are expected to be strings of the form ``f&quot;{prefix_flow}_{idx}&quot;``.</span>
<span class="sd">        prefix_potential : str, default=&quot;node&quot;</span>
<span class="sd">            Prefix of columns that hold node potentials. Same column naming</span>
<span class="sd">            convention as for prefix_flow applies.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ParametricSolution</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get flow and potential indices</span>
        <span class="n">edge_cols</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">i</span>
                     <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                     <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix_flow</span><span class="p">)}</span>
        <span class="n">edge_cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">edge_cols</span><span class="o">.</span><span class="n">values</span><span class="p">()))[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">edge_cols</span><span class="o">.</span><span class="n">keys</span><span class="p">()))]</span>
        <span class="n">node_cols</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">i</span>
                     <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                     <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix_potential</span><span class="p">)}</span>
        <span class="n">node_cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">node_cols</span><span class="o">.</span><span class="n">values</span><span class="p">()))[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">node_cols</span><span class="o">.</span><span class="n">keys</span><span class="p">()))]</span>
        
        <span class="c1"># Get interpolation values for x after last breakpoint (if available)</span>
        <span class="n">dflow</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">dpi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s2">&quot;delta&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">dflow</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;delta&quot;</span><span class="p">][</span><span class="n">edge_cols</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node_cols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">dpi</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;delta&quot;</span><span class="p">][</span><span class="n">node_cols</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;delta&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="c1"># Get params</span>
        <span class="k">if</span> <span class="s2">&quot;param&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
            <span class="c1"># Param is column</span>
            <span class="n">param</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Params are in index</span>
            <span class="n">param</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
        
        <span class="c1"># Get flow</span>
        <span class="n">arr_flow</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span> <span class="n">edge_cols</span><span class="p">]</span>
        
        <span class="c1"># Get potentials</span>
        <span class="n">arr_pot</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node_cols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Potential columns exist</span>
            <span class="n">arr_pot</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span> <span class="n">node_cols</span><span class="p">]</span>
        <span class="n">arr_cost</span> <span class="o">=</span> <span class="kc">None</span>
        
        <span class="c1"># Get cost</span>
        <span class="k">if</span> <span class="s2">&quot;cost&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
            <span class="n">arr_cost</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">cost</span><span class="o">.</span><span class="n">values</span>
        
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">arr_flow</span><span class="p">,</span> <span class="n">arr_pot</span><span class="p">,</span> <span class="n">arr_cost</span><span class="p">,</span> <span class="n">dflow</span><span class="p">,</span> <span class="n">dpi</span><span class="p">)</span></div>

<div class="viewcode-block" id="ParametricSolution.to_csv"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolution.to_csv.html#paminco._base.ParametricSolution.to_csv">[docs]</a>    <span class="k">def</span> <span class="nf">to_csv</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">file</span><span class="p">,</span>
            <span class="n">prefix_flow</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;edge&quot;</span><span class="p">,</span>
            <span class="n">prefix_potential</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;node&quot;</span><span class="p">,</span>
            <span class="n">add_delta_row</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Save ParametricSolution to ``CSV``.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file : str or file handle</span>
<span class="sd">            File to save ParametricSolution to, passed to</span>
<span class="sd">            :func:`pandas.DataFrame.to_csv`.</span>
<span class="sd">        prefix_flow : str, default=&quot;edge&quot;</span>
<span class="sd">            Prefix of flow columns.</span>
<span class="sd">        prefix_potential : str, default=&quot;node&quot;</span>
<span class="sd">            Prefix of potential columns.</span>
<span class="sd">        add_delta_row : bool, default=False</span>
<span class="sd">            If True, a row will be appended that contains the slope values</span>
<span class="sd">            of flow (and potential).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">prefix_flow</span><span class="o">=</span><span class="n">prefix_flow</span><span class="p">,</span>
                        <span class="n">prefix_potential</span><span class="o">=</span><span class="n">prefix_potential</span><span class="p">,</span>
                        <span class="n">add_delta_row</span><span class="o">=</span><span class="n">add_delta_row</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">index_label</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="ParametricSolution.from_csv"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolution.from_csv.html#paminco._base.ParametricSolution.from_csv">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_csv</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span>
            <span class="n">file</span><span class="p">,</span>
            <span class="n">prefix_flow</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;edge&quot;</span><span class="p">,</span>
            <span class="n">prefix_potential</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;node&quot;</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParametricSolution</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build ParametricSolution from ``CSV``.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file : str, path object or file-like object</span>
<span class="sd">            File passed to :func:`pandas.read_csv`.</span>
<span class="sd">        prefix_flow : str, default=&quot;edge&quot;</span>
<span class="sd">            Prefix of columns in ``df`` that hold edge flows. Column names</span>
<span class="sd">            are expected to be strings of the form ``f&quot;{prefix_flow}_{idx}&quot;``.</span>
<span class="sd">        prefix_potential : str, default=&quot;node&quot;</span>
<span class="sd">            Prefix of columns that hold node potentials. Same column naming</span>
<span class="sd">            convention as for prefix_flow applies.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ParametricSolution</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">prefix_flow</span><span class="o">=</span><span class="n">prefix_flow</span><span class="p">,</span>
            <span class="n">prefix_potential</span><span class="o">=</span><span class="n">prefix_potential</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ParametricSolution.from_npz"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolution.from_npz.html#paminco._base.ParametricSolution.from_npz">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_npz</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParametricSolution</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span>
            <span class="n">param</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;arr_param&quot;</span><span class="p">],</span>
            <span class="n">flow</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;arr_flow&quot;</span><span class="p">],</span>
            <span class="n">potential</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;arr_potential&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">cost</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;arr_cost&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">dflow</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;dflow&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">dpi</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;dpi&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">)</span></div>

    <span class="n">from_npz</span><span class="o">.</span><span class="vm">__func__</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_doc</span><span class="o">.</span><span class="n">from_npz</span><span class="o">.</span><span class="vm">__doc__</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_potentials</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether node potentials have been set in breakpoint solutions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">potential</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_costs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether cost have been set in breakpoint solutions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cost</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arr_param</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;1D array (B, ) of float: parameters of breakpoint solutions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">param</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arr_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;2D array (B, m) of float: edge flows of breakpoint solutions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">flow</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arr_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;1D array (B, ) of float: total cost of breakpoint solutions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">cost</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arr_potential</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;2D array (B, n) of float: node potential of breakpoint solutions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">potential</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dflow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get slope of flow after last breakpoint.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_dflow&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dflow</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get slope of potential after last breakpoint.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_dpi&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dpi</span></div>


<div class="viewcode-block" id="ParametricSolver"><a class="viewcode-back" href="../../api/base/solver.html#paminco._base.ParametricSolver">[docs]</a><span class="k">class</span> <span class="nc">ParametricSolver</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Solver that calculate parametric min cost flows.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    param_solution : ParametricSolution.</span>
<span class="sd">        List that stores `B` breakpoint solutions. Holds all data to to</span>
<span class="sd">        interpolate flows, potentials.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="ParametricSolver.__call__"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolver.__call__.html#paminco._base.ParametricSolver.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flow_at</span><span class="p">(</span><span class="n">param</span><span class="p">)</span></div>

<div class="viewcode-block" id="ParametricSolver.flow_at"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolver.flow_at.html#paminco._base.ParametricSolver.flow_at">[docs]</a>    <span class="k">def</span> <span class="nf">flow_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_solution</span><span class="o">.</span><span class="n">flow_at</span><span class="p">(</span><span class="n">param</span><span class="p">)</span></div>

    <span class="n">flow_at</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">ParametricSolution</span><span class="o">.</span><span class="n">flow_at</span><span class="o">.</span><span class="vm">__doc__</span>
    
<div class="viewcode-block" id="ParametricSolver.potential_at"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolver.potential_at.html#paminco._base.ParametricSolver.potential_at">[docs]</a>    <span class="k">def</span> <span class="nf">potential_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_solution</span><span class="o">.</span><span class="n">potential_at</span><span class="p">(</span><span class="n">param</span><span class="p">)</span></div>

    <span class="n">potential_at</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">ParametricSolution</span><span class="o">.</span><span class="n">potential_at</span><span class="o">.</span><span class="vm">__doc__</span>

<div class="viewcode-block" id="ParametricSolver.cost_at"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolver.cost_at.html#paminco._base.ParametricSolver.cost_at">[docs]</a>    <span class="k">def</span> <span class="nf">cost_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Interpolate cost at param.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        param : array_like</span>
<span class="sd">            1D array of real values to interpolate cost at.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float or ndarray</span>
<span class="sd">            Cost at param, 1D array.</span>
<span class="sd">        </span>
<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        scipy.interpolate.interp1d</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">cost</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flow_at</span><span class="p">(</span><span class="n">param</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">cost</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                             <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flow_at</span><span class="p">(</span><span class="n">param</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">])</span></div>

<div class="viewcode-block" id="ParametricSolver.all_params"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolver.all_params.html#paminco._base.ParametricSolver.all_params">[docs]</a>    <span class="k">def</span> <span class="nf">all_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_solution</span><span class="o">.</span><span class="n">all_params</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
    
    <span class="n">all_params</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">ParametricSolution</span><span class="o">.</span><span class="n">all_params</span><span class="o">.</span><span class="vm">__doc__</span>

<div class="viewcode-block" id="ParametricSolver.plot_flow_on_edge"><a class="viewcode-back" href="../../api/base/generated/paminco._base.ParametricSolver.plot_flow_on_edge.html#paminco._base.ParametricSolver.plot_flow_on_edge">[docs]</a>    <span class="k">def</span> <span class="nf">plot_flow_on_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_solution</span><span class="o">.</span><span class="n">plot_flow_on_edge</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
    
    <span class="n">plot_flow_on_edge</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">ParametricSolution</span><span class="o">.</span><span class="n">plot_flow_on_edge</span><span class="o">.</span><span class="vm">__doc__</span>

    <span class="k">def</span> <span class="nf">_add_param_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_solution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BreakpointSolution</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_set_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># calculate cost at all solution breakpoints</span>
        <span class="k">for</span> <span class="n">ps</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_solution</span><span class="p">:</span>
            <span class="n">ps</span><span class="o">.</span><span class="n">cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">cost</span><span class="p">(</span><span class="n">ps</span><span class="o">.</span><span class="n">flow</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">close_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dflow</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close run of solver.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_solution</span><span class="o">.</span><span class="n">set_interpolators</span><span class="p">(</span><span class="n">dflow</span><span class="o">=</span><span class="n">dflow</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">param_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParametricSolution</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get ParametricSolution object.</span>
<span class="sd">        </span>
<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        ParametricSolution</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_solution</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get configuration of solver.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c</span></div>


<div class="viewcode-block" id="AlphaBetaApproximativeSolver"><a class="viewcode-back" href="../../api/base/abapprox.html#paminco._base.AlphaBetaApproximativeSolver">[docs]</a><span class="k">class</span> <span class="nc">AlphaBetaApproximativeSolver</span><span class="p">(</span><span class="n">ParametricSolver</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
</pre></div>

              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Philipp Warode, Per Joachims.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.3.1.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>